setwd("//uni.au.dk/Users/au99392/Documents/Work/R files/temperature_resistance")
setwd("/faststorage/project/spider2/assay_study_anne/phenotypes/data/ToD/")
ToD_raw <- read.table("Complete_data_file_ToD_270218.txt", header = TRUE, sep = "", dec = ',')

ToD <- ToD_raw[!grepl("E001", ToD_raw$Nest),]

modelToD <- lm(ToD ~ Population + Treatment + Population *Treatment, data=ToD)
summary(modelToD)

#subset - ToD - population
ToDN <- subset(ToD, Population == "North")
ToDS <- subset(ToD, Population == "Stampriet")
ToDK <- subset(ToD, Population == "Karasburg")
ToDB <- subset(ToD, Population == "Betta")


par(mfrow=c(3,4))
plot(ToDN$D_21, ToDN$ToD, xlim =c(0,100), ylim=c(44,54))
abline(lm(ToDN$ToD ~ ToDN$D_21))
plot(ToDS$D_21, ToDS$ToD, xlim =c(0,100), ylim=c(44,54))
abline(lm(ToDS$ToD ~ ToDS$D_21))
plot(ToDK$D_21, ToDK$ToD, xlim =c(0,100), ylim=c(44,54))
abline(lm(ToDK$ToD ~ ToDK$D_21))
plot(ToDB$D_21, ToDB$ToD, xlim =c(0,100), ylim=c(44,54))
abline(lm(ToDB$ToD ~ ToDB$D_21))

#models - D_21
modelToDN_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDN)
statToDN_D_21 <- summary(modelToDN_D_21)
modelToDS_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDS)
statToDS_D_21 <- summary(modelToDS_D_21)
modelToDK_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDK)
statToDK_D_21 <- summary(modelToDK_D_21)
modelToDB_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDB)
statToDB_D_21 <- summary(modelToDB_D_21)

plot(ToDN$Mass, ToDN$ToD, xlim =c(0,50), ylim=c(44,54))
abline(lm(ToDN$ToD ~ ToDN$Mass))
plot(ToDS$Mass, ToDS$ToD, xlim =c(0,50), ylim=c(44,54))
abline(lm(ToDS$ToD ~ ToDS$Mass))
plot(ToDK$Mass, ToDK$ToD, xlim =c(0,50), ylim=c(44,54))
abline(lm(ToDK$ToD ~ ToDK$Mass))
plot(ToDB$Mass, ToDB$ToD, xlim =c(0,50), ylim=c(44,54))
abline(lm(ToDB$ToD ~ ToDB$Mass))

#models - Mass
modelToDN_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDN)
statToDN_Mass <- summary(modelToDN_Mass)
modelToDS_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDS)
statToDS_Mass <- summary(modelToDS_Mass)
modelToDK_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDK)
statToDK_Mass <- summary(modelToDK_Mass)
modelToDB_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDB)
statToDB_Mass <- summary(modelToDB_Mass)

plot(ToDN$Fed, ToDN$ToD, xlim =c(0,5), ylim=c(44,54))
abline(lm(ToDN$ToD ~ ToDN$Fed))
plot(ToDS$Fed, ToDS$ToD, xlim =c(0,5), ylim=c(44,54))
abline(lm(ToDS$ToD ~ ToDS$Fed))
plot(ToDK$Fed, ToDK$ToD, xlim =c(0,5), ylim=c(44,54))
abline(lm(ToDK$ToD ~ ToDK$Fed))
plot(ToDB$Fed, ToDB$ToD, xlim =c(0,5), ylim=c(44,54))
abline(lm(ToDB$ToD ~ ToDB$Fed))

#models - Fed
modelToDN_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDN)
statToDN_Fed <- summary(modelToDN_Fed)
modelToDS_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDS)
statToDS_Fed <- summary(modelToDS_Fed)
modelToDK_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDK)
statToDK_Fed <- summary(modelToDK_Fed)
modelToDB_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDB)
statToDB_Fed <- summary(modelToDB_Fed)

#subset - ToD - population - treatment
ToDN15 <- subset(ToDN, Treatment == "15")
ToDN19 <- subset(ToDN, Treatment == "19")
ToDN23 <- subset(ToDN, Treatment == "23")
ToDN25 <- subset(ToDN, Treatment == "25")
ToDN29 <- subset(ToDN, Treatment == "29")

###

pdf("North.pdf", width=18, height=15)
par(mfrow=c(3,5))
plot(ToDN15$D_21, ToDN15$ToD, xlim =c(0,100))
abline(lm(ToDN15$ToD ~ ToDN15$D_21))
modelToDN15_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDN15)
statToDN15_D_21 <- summary(modelToDN15_D_21)
plot(ToDN19$D_21, ToDN19$ToD, xlim =c(0,100))
abline(lm(ToDN19$ToD ~ ToDN19$D_21))
modelToDN19_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDN19)
statToDN19_D_21 <- summary(modelToDN19_D_21)
plot(ToDN23$D_21, ToDN23$ToD, xlim =c(0,100))
abline(lm(ToDN23$ToD ~ ToDN23$D_21))
modelToDN23_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDN23)
statToDN23_D_21 <- summary(modelToDN23_D_21)
plot(ToDN25$D_21, ToDN25$ToD, xlim =c(0,100))
abline(lm(ToDN25$ToD ~ ToDN25$D_21))
modelToDN25_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDN25)
statToDN25_D_21 <- summary(modelToDN25_D_21)
plot(ToDN29$D_21, ToDN29$ToD, xlim =c(0,100))
abline(lm(ToDN29$ToD ~ ToDN29$D_21))
modelToDN29_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDN29)
statToDN29_D_21 <- summary(modelToDN29_D_21)
####
plot(ToDN15$Mass, ToDN15$ToD, xlim =c(0,50))
abline(lm(ToDN15$ToD ~ ToDN15$Mass))
modelToDN15_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDN15)
statToDN15_Mass <- summary(modelToDN15_Mass)
plot(ToDN19$Mass, ToDN19$ToD, xlim =c(0,50))
abline(lm(ToDN19$ToD ~ ToDN19$Mass))
modelToDN19_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDN19)
statToDN19_Mass  <- summary(modelToDN19_Mass )
plot(ToDN23$Mass , ToDN23$ToD, xlim =c(0,50))
abline(lm(ToDN23$ToD ~ ToDN23$Mass ))
modelToDN23_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDN23)
statToDN23_Mass <- summary(modelToDN23_Mass)
plot(ToDN25$Mass, ToDN25$ToD, xlim =c(0,50))
abline(lm(ToDN25$ToD ~ ToDN25$Mass))
modelToDN25_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDN25)
statToDN25_Mass <- summary(modelToDN25_Mass)
plot(ToDN29$Mass, ToDN29$ToD, xlim =c(0,50))
abline(lm(ToDN29$ToD ~ ToDN29$Mass))
modelToDN29_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDN29)
statToDN29_Mass <- summary(modelToDN29_Mass)
####
plot(ToDN15$Fed, ToDN15$ToD, xlim =c(0,5))
abline(lm(ToDN15$ToD ~ ToDN15$Fed))
modelToDN15_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDN15)
statToDN15_Fed <- summary(modelToDN15_Fed)
plot(ToDN19$Fed, ToDN19$ToD, xlim =c(0,5))
abline(lm(ToDN19$ToD ~ ToDN19$Fed))
modelToDN19_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDN19)
statToDN19_Fed <- summary(modelToDN19_Fed)
plot(ToDN23$Fed, ToDN23$ToD, xlim =c(0,5))
abline(lm(ToDN23$ToD ~ ToDN23$Fed))
modelToDN23_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDN23)
statToDN23_Fed <- summary(modelToDN23_Fed)
plot(ToDN25$Fed, ToDN25$ToD, xlim =c(0,5))
abline(lm(ToDN25$ToD ~ ToDN25$Fed))
modelToDN25_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDN25)
statToDN25_Fed <- summary(modelToDN25_Fed)
plot(ToDN29$Fed, ToDN29$ToD, xlim =c(0,5))
abline(lm(ToDN29$ToD ~ ToDN29$Fed))
modelToDN29_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDN29)
statToDN29_Fed <- summary(modelToDN29_Fed)
dev.off()
#####

ToDS15 <- subset(ToDS, Treatment == "15")
ToDS19 <- subset(ToDS, Treatment == "19")
ToDS23 <- subset(ToDS, Treatment == "23")
ToDS25 <- subset(ToDS, Treatment == "25")
ToDS29 <- subset(ToDS, Treatment == "29")

###
pdf("S.pdf", width=18, height=15)
par(mfrow=c(3,5))
plot(ToDS15$D_21, ToDS15$ToD, xlim =c(0,100))
abline(lm(ToDS15$ToD ~ ToDS15$D_21))
modelToDS15_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDS15)
statToDS15_D_21 <- summary(modelToDS15_D_21)
plot(ToDS19$D_21, ToDS19$ToD, xlim =c(0,100))
abline(lm(ToDS19$ToD ~ ToDS19$D_21))
modelToDS19_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDS19)
statToDS19_D_21 <- summary(modelToDS19_D_21)
plot(ToDS23$D_21, ToDS23$ToD, xlim =c(0,100))
abline(lm(ToDS23$ToD ~ ToDS23$D_21))
modelToDS23_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDS23)
statToDS23_D_21 <- summary(modelToDS23_D_21)
plot(ToDS25$D_21, ToDS25$ToD, xlim =c(0,100))
abline(lm(ToDS25$ToD ~ ToDS25$D_21))
modelToDS25_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDS25)
statToDS25_D_21 <- summary(modelToDS25_D_21)
plot(ToDS29$D_21, ToDS29$ToD, xlim =c(0,100))
abline(lm(ToDS29$ToD ~ ToDS29$D_21))
modelToDS29_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDS29)
statToDS29_D_21 <- summary(modelToDS29_D_21)
####
plot(ToDS15$Mass, ToDS15$ToD, xlim =c(0,50))
abline(lm(ToDS15$ToD ~ ToDS15$Mass))
modelToDS15_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDS15)
statToDS15_Mass <- summary(modelToDS15_Mass)
plot(ToDS19$Mass, ToDS19$ToD, xlim =c(0,50))
abline(lm(ToDS19$ToD ~ ToDS19$Mass))
modelToDS19_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDS19)
statToDS19_Mass  <- summary(modelToDS19_Mass )
plot(ToDS23$Mass , ToDS23$ToD, xlim =c(0,50))
abline(lm(ToDS23$ToD ~ ToDS23$Mass ))
modelToDS23_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDS23)
statToDS23_Mass <- summary(modelToDS23_Mass)
plot(ToDS25$Mass, ToDS25$ToD, xlim =c(0,50))
abline(lm(ToDS25$ToD ~ ToDS25$Mass))
modelToDS25_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDS25)
statToDS25_Mass <- summary(modelToDS25_Mass)
plot(ToDS29$Mass, ToDS29$ToD, xlim =c(0,50))
abline(lm(ToDS29$ToD ~ ToDS29$Mass))
modelToDS29_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDS29)
statToDS29_Mass <- summary(modelToDS29_Mass)
####
plot(ToDS15$Fed, ToDS15$ToD, xlim =c(0,5))
abline(lm(ToDS15$ToD ~ ToDS15$Fed))
modelToDS15_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDS15)
statToDS15_Fed <- summary(modelToDS15_Fed)
plot(ToDS19$Fed, ToDS19$ToD, xlim =c(0,5))
abline(lm(ToDS19$ToD ~ ToDS19$Fed))
modelToDS19_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDS19)
statToDS19_Fed <- summary(modelToDS19_D_21)
plot(ToDS23$Fed, ToDS23$ToD, xlim =c(0,5))
abline(lm(ToDS23$ToD ~ ToDS23$Fed))
modelToDS23_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDS23)
statToDS23_Fed <- summary(modelToDS23_Fed)
plot(ToDS25$Fed, ToDS25$ToD, xlim =c(0,5))
abline(lm(ToDS25$ToD ~ ToDS25$Fed))
modelToDS25_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDS25)
statToDS25_Fed <- summary(modelToDS25_Fed)
plot(ToDS29$Fed, ToDS29$ToD, xlim =c(0,5))
abline(lm(ToDS29$ToD ~ ToDS29$Fed))
modelToDS29_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDS29)
statToDS29_Fed <- summary(modelToDS29_Fed)
dev.off()
#####

ToDK15 <- subset(ToDK, Treatment == "15")
ToDK19 <- subset(ToDK, Treatment == "19")
ToDK23 <- subset(ToDK, Treatment == "23")
ToDK25 <- subset(ToDK, Treatment == "25")
ToDK29 <- subset(ToDK, Treatment == "29")

###
pdf("Karasburg.pdf", width=18, height=15)
par(mfrow=c(3,5))
plot(ToDK15$D_21, ToDK15$ToD, xlim =c(0,100))
abline(lm(ToDK15$ToD ~ ToDK15$D_21))
modelToDK15_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDK15)
statToDK15_D_21 <- summary(modelToDK15_D_21)
plot(ToDK19$D_21, ToDK19$ToD, xlim =c(0,100))
abline(lm(ToDK19$ToD ~ ToDK19$D_21))
modelToDK19_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDK19)
statToDK19_D_21 <- summary(modelToDK19_D_21)
plot(ToDK23$D_21, ToDK23$ToD, xlim =c(0,100))
abline(lm(ToDK23$ToD ~ ToDK23$D_21))
modelToDK23_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDK23)
statToDK23_D_21 <- summary(modelToDK23_D_21)
plot(ToDK25$D_21, ToDK25$ToD, xlim =c(0,100))
abline(lm(ToDK25$ToD ~ ToDK25$D_21))
modelToDK25_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDK25)
statToDK25_D_21 <- summary(modelToDK25_D_21)
plot(ToDK29$D_21, ToDK29$ToD, xlim =c(0,100))
abline(lm(ToDK29$ToD ~ ToDK29$D_21))
modelToDK29_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDK29)
statToDK29_D_21 <- summary(modelToDK29_D_21)
####
plot(ToDK15$Mass, ToDK15$ToD, xlim =c(0,50))
abline(lm(ToDK15$ToD ~ ToDK15$Mass))
modelToDK15_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDK15)
statToDK15_Mass <- summary(modelToDK15_Mass)
plot(ToDK19$Mass, ToDK19$ToD, xlim =c(0,50))
abline(lm(ToDK19$ToD ~ ToDK19$Mass))
modelToDK19_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDK19)
statToDK19_Mass <- summary(modelToDK19_Mass)
plot(ToDK23$Mass, ToDK23$ToD, xlim =c(0,50))
abline(lm(ToDK23$ToD ~ ToDK23$Mass))
modelToDK23_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDK23)
statToDK23_Mass <- summary(modelToDK23_Mass)
plot(ToDK25$Mass, ToDK25$ToD, xlim =c(0,50))
abline(lm(ToDK25$ToD ~ ToDK25$Mass))
modelToDK25_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDK25)
statToDK25_Mass <- summary(modelToDK25_Mass)
plot(ToDK29$Mass, ToDK29$ToD, xlim =c(0,50))
abline(lm(ToDK29$ToD ~ ToDK29$Mass))
modelToDK29_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDK29)
statToDK29_Mass <- summary(modelToDK29_Mass)
####
plot(ToDK15$Fed, ToDK15$ToD, xlim =c(0,5))
abline(lm(ToDK15$ToD ~ ToDK15$Fed))
modelToDK15_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDK15)
statToDK15_Fed <- summary(modelToDK15_Fed)
plot(ToDK19$Fed, ToDK19$ToD, xlim =c(0,5))
abline(lm(ToDK19$ToD ~ ToDK19$Fed))
modelToDK19_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDK19)
statToDK19_Fed <- summary(modelToDK19_Fed)
plot(ToDK23$Fed, ToDK23$ToD, xlim =c(0,5))
abline(lm(ToDK23$ToD ~ ToDK23$Fed))
modelToDK23_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDK23)
statToDK23_Fed <- summary(modelToDK23_Fed)
plot(ToDK25$Fed, ToDK25$ToD, xlim =c(0,5))
abline(lm(ToDK25$ToD ~ ToDK25$Fed))
modelToDK25_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDK25)
statToDK25_Fed <- summary(modelToDK25_Fed)
plot(ToDK29$Fed, ToDK29$ToD, xlim =c(0,5))
abline(lm(ToDK29$ToD ~ ToDK29$Fed))
modelToDK29_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDK29)
statToDK29_Fed <- summary(modelToDK29_Fed)
dev.off()
#####

ToDB15 <- subset(ToDB, Treatment == "15")
ToDB19 <- subset(ToDB, Treatment == "19")
ToDB23 <- subset(ToDB, Treatment == "23")
ToDB25 <- subset(ToDB, Treatment == "25")
ToDB29 <- subset(ToDB, Treatment == "29")

###
pdf("Betta.pdf", width=18, height=15)
par(mfrow=c(3,5))
plot(ToDB15$D_21, ToDB15$ToD, xlim =c(0,100))
abline(lm(ToDB15$ToD ~ ToDB15$D_21))
modelToDB15_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDB15)
statToDB15_D_21 <- summary(modelToDB15_D_21)
plot(ToDB19$D_21, ToDB19$ToD, xlim =c(0,100))
abline(lm(ToDB19$ToD ~ ToDB19$D_21))
modelToDB19_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDB19)
statToDB19_D_21 <- summary(modelToDB19_D_21)
plot(ToDB23$D_21, ToDB23$ToD, xlim =c(0,100))
abline(lm(ToDB23$ToD ~ ToDB23$D_21))
modelToDB23_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDB23)
statToDB23_D_21 <- summary(modelToDB23_D_21)
plot(ToDB25$D_21, ToDB25$ToD, xlim =c(0,100))
abline(lm(ToDB25$ToD ~ ToDB25$D_21))
modelToDB25_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDB25)
statToDB25_D_21 <- summary(modelToDB25_D_21)
plot(ToDB29$D_21, ToDB29$ToD, xlim =c(0,100))
abline(lm(ToDB29$ToD ~ ToDB29$D_21))
modelToDB29_D_21 <- lm(ToD ~ D_21 + Treatment + D_21*Treatment, data=ToDB29)
statToDB29_D_21 <- summary(modelToDB29_D_21)
####
plot(ToDB15$Mass, ToDB15$ToD, xlim =c(0,50))
abline(lm(ToDB15$ToD ~ ToDB15$Mass))
modelToDB15_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDB15)
statToDB15_Mass <- summary(modelToDB15_Mass)
plot(ToDB19$Mass, ToDB19$ToD, xlim =c(0,50))
abline(lm(ToDB19$ToD ~ ToDB19$Mass))
modelToDB19_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDB19)
statToDB19_Mass  <- summary(modelToDB19_Mass)
plot(ToDB23$Mass , ToDB23$ToD, xlim =c(0,50))
abline(lm(ToDB23$ToD ~ ToDB23$Mass ))
modelToDB23_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDB23)
statToDB23_Mass <- summary(modelToDB23_Mass)
plot(ToDB25$Mass, ToDB25$ToD, xlim =c(0,50))
abline(lm(ToDB25$ToD ~ ToDB25$Mass))
modelToDB25_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDB25)
statToDB25_Mass <- summary(modelToDB25_Mass)
plot(ToDB29$Mass, ToDB29$ToD, xlim =c(0,50))
abline(lm(ToDB29$ToD ~ ToDB29$Mass))
modelToDB29_Mass <- lm(ToD ~ Mass + Treatment + Mass*Treatment, data=ToDB29)
statToDB29_Mass <- summary(modelToDB29_Mass)
####
plot(ToDB15$Fed, ToDB15$ToD, xlim =c(0,5))
abline(lm(ToDB15$ToD ~ ToDB15$Fed))
modelToDB15_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDB15)
statToDB15_Fed <- summary(modelToDB15_Fed)
plot(ToDB19$Fed, ToDB19$ToD, xlim =c(0,5))
abline(lm(ToDB19$ToD ~ ToDB19$Fed))
modelToDB19_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDB19)
statToDB19_Fed  <- summary(modelToDB19_Fed )
plot(ToDB23$Fed , ToDB23$ToD, xlim =c(0,5))
abline(lm(ToDB23$ToD ~ ToDB23$Fed ))
modelToDB23_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDB23)
statToDB23_Fed <- summary(modelToDB23_Fed)
plot(ToDB25$Fed, ToDB25$ToD, xlim =c(0,5))
abline(lm(ToDB25$ToD ~ ToDB25$Fed))
modelToDB25_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDB25)
statToDB25_Fed <- summary(modelToDB25_Fed)
plot(ToDB29$Fed, ToDB29$ToD, xlim =c(0,5))
abline(lm(ToDB29$ToD ~ ToDB29$Fed))
modelToDB29_Fed <- lm(ToD ~ Fed + Treatment + Fed*Treatment, data=ToDB29)
statToDB29_Fed <- summary(modelToDB29_Fed)
dev.off()
#####

##reduced data ("ToD_reduced")

index <- ToD[,4]==1
ToD_mean <- colMeans(matrix(ToD$ToD,10),na.rm=T)
ToD_reduced <- cbind(ToD[index,],ToD_mean)

####Nest E001 has very low values in all acclimation temperatures, and is removed here########

ToD_final <- ToD_reduced[!grepl("E001", ToD_reduced$Nest),]

plot(ToD_final$Treatment, ToD_final$ToD_mean, ylim=c(44,54))
abline(lm(ToD_final$ToD_mean ~ ToD_final$Treatment))

modelToD_final <- lm(ToD_mean ~ Population + Treatment + Population * Treatment, data=ToD_final)
summary(modelToD_final)
ToDaov <- aov(ToD_mean ~ Population + Treatment + Population*Treatment, data=ToD_final)
summary(ToDaov)
#########

#subset - ToD_final - population
ToD_finalN <- subset(ToD_final, Population == "North")
ToD_finalS <- subset(ToD_final, Population == "S")
ToD_finalK <- subset(ToD_final, Population == "Karasburg")
ToD_finalB <- subset(ToD_final, Population == "Betta")

par(mfrow=c(1,4))
plot(ToD_finalN$Treatment, ToD_finalN$ToD_mean, ylim=c(48,52), xlab = "Treatment", ylab = "CTmax", main = "Critical thermal maximum - North")
abline(lm(ToD_finalN$ToD_mean ~ ToD_finalN$Treatment), col = "red")
plot(ToD_finalS$Treatment, ToD_finalS$ToD_mean, ylim=c(48,52), xlab = "Treatment", ylab = "CTmax", main = "Critical thermal maximum - Stampriet")
abline(lm(ToD_finalS$ToD_mean ~ ToD_finalS$Treatment), col = "blue")
plot(ToD_finalK$Treatment, ToD_finalK$ToD_mean, ylim=c(48,52), xlab = "Treatment", ylab = "CTmax", main = "Critical thermal maximum - Karasburg")
abline(lm(ToD_finalK$ToD_mean ~ ToD_finalK$Treatment), col = "green")
plot(ToD_finalB$Treatment, ToD_finalB$ToD_mean, ylim=c(48,52), xlab = "Treatment", ylab = "CTmax", main = "Critical thermal maximum - Betta")
abline(lm(ToD_finalB$ToD_mean ~ ToD_finalB$Treatment), col = "black")

#models
modelToD_finalN <- lm(ToD ~ Treatment, data=ToD_finalN)
statToD_finalN <- summary(modelToD_finalN)
modelToD_finalS <- lm(ToD ~ Treatment, data=ToD_finalS)
statToD_finalS <- summary(modelToD_finalS)
modelToD_finalK <- lm(ToD ~ Treatment, data=ToD_finalK)
statToD_finalK <- summary(modelToD_finalK)
modelToD_finalB <- lm(ToD ~ Treatment, data=ToD_finalB)
statToD_finalB <- summary(modelToD_finalB)

par(mfrow=c(4,4))
plot(modelToD_finalN)
plot(modelToD_finalS)
plot(modelToD_finalK)
plot(modelToD_finalB)

#subset - ToD_final - treatment
ToD_final15 <- subset(ToD_final, Treatment == "15")
ToD_final19 <- subset(ToD_final, Treatment == "19")
ToD_final23 <- subset(ToD_final, Treatment == "23")
ToD_final25 <- subset(ToD_final, Treatment == "25")
ToD_final29 <- subset(ToD_final, Treatment == "29")

par(mfrow=c(1,5))
plot(factor(ToD_final15$Population, levels = c("Betta", "S", "Karasburg", "North")), ToD_final15$ToD_mean, ylim=c(48,52), xlab = "Population", ylab = "CTmax", main = "Acclimation - 15")
plot(factor(ToD_final19$Population, levels = c("Betta", "S", "Karasburg", "North")), ToD_final19$ToD_mean, ylim=c(48,52), xlab = "Population", ylab = "CTmax", main = "Acclimation - 19")
plot(factor(ToD_final23$Population, levels = c("Betta", "S", "Karasburg", "North")), ToD_final23$ToD_mean, ylim=c(48,52), xlab = "Population", ylab = "CTmax", main = "Acclimation - 23")
plot(factor(ToD_final25$Population, levels = c("Betta", "S", "Karasburg", "North")), ToD_final25$ToD_mean, ylim=c(48,52), xlab = "Population", ylab = "CTmax", main = "Acclimation - 25")
plot(factor(ToD_final29$Population, levels = c("Betta", "S", "Karasburg", "North")), ToD_final29$ToD_mean, ylim=c(48,52), xlab = "Population", ylab = "CTmax", main = "Acclimation - 29")

#models
modelToD_final15 <- lm(ToD ~ Population, data=ToD_final15)
statToD_final15 <- summary(modelToD_final15)
modelToD_final19 <- lm(ToD ~ Population, data=ToD_final19)
statToD_final19 <- summary(modelToD_final19)
modelToD_final23 <- lm(ToD ~ Population, data=ToD_final23)
statToD_final23 <- summary(modelToD_final23)
modelToD_final25 <- lm(ToD ~ Population, data=ToD_final25)
statToD_final25 <- summary(modelToD_final25)
modelToD_final29 <- lm(ToD ~ Population, data=ToD_final29)
statToD_final29 <- summary(modelToD_final29)

par(mfrow=c(5,4))
plot(modelToD_final15)
plot(modelToD_final19)
plot(modelToD_final23)
plot(modelToD_final25)
plot(modelToD_final29)

#####################
#plots

ToD_finalN15 <- subset(ToD_final, Population == "North" & Treatment == "15")
ToD_finalN19 <- subset(ToD_final, Population == "North" & Treatment == "19")
ToD_finalN23 <- subset(ToD_final, Population == "North" & Treatment == "23")
ToD_finalN25 <- subset(ToD_final, Population == "North" & Treatment == "25")
ToD_finalN29 <- subset(ToD_final, Population == "North" & Treatment == "29")
ToD_finalS15 <- subset(ToD_final, Population == "S" & Treatment == "15")
ToD_finalS19 <- subset(ToD_final, Population == "S" & Treatment == "19")
ToD_finalS23 <- subset(ToD_final, Population == "S" & Treatment == "23")
ToD_finalS25 <- subset(ToD_final, Population == "S" & Treatment == "25")
ToD_finalS29 <- subset(ToD_final, Population == "S" & Treatment == "29")
ToD_finalK15 <- subset(ToD_final, Population == "Karasburg" & Treatment == "15")
ToD_finalK19 <- subset(ToD_final, Population == "Karasburg" & Treatment == "19")
ToD_finalK23 <- subset(ToD_final, Population == "Karasburg" & Treatment == "23")
ToD_finalK25 <- subset(ToD_final, Population == "Karasburg" & Treatment == "25")
ToD_finalK29 <- subset(ToD_final, Population == "Karasburg" & Treatment == "29")
ToD_finalB15 <- subset(ToD_final, Population == "Betta" & Treatment == "15")
ToD_finalB19 <- subset(ToD_final, Population == "Betta" & Treatment == "19")
ToD_finalB23 <- subset(ToD_final, Population == "Betta" & Treatment == "23")
ToD_finalB25 <- subset(ToD_final, Population == "Betta" & Treatment == "25")
ToD_finalB29 <- subset(ToD_final, Population == "Betta" & Treatment == "29")


Treat <- c(15, 19, 23, 25, 29)
NmCTmax <- c(colMeans(matrix(ToD_finalN15$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalN19$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalN23$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalN25$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalN29$ToD_mean),na.rm=T))
SmCTmax <- c(colMeans(matrix(ToD_finalS15$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalS19$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalS23$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalS25$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalS29$ToD_mean),na.rm=T))
KmCTmax <- c(colMeans(matrix(ToD_finalK15$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalK19$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalK23$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalK25$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalK29$ToD_mean),na.rm=T))
BmCTmax <- c(colMeans(matrix(ToD_finalB15$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalB19$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalB23$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalB25$ToD_mean),na.rm=T), colMeans(matrix(ToD_finalB29$ToD_mean),na.rm=T))


plot(Treat, NmCTmax, , col = "red", ylim = c(48,52), ylab = "CTmax", xlab ="Acclimation temperature", main ="Critical thermal maximum")
abline(lm(NmCTmax ~Treat), col = "red")
legend(9,7,"Betta")
par(new=TRUE)
plot(Treat, SmCTmax, , col = "blue", ylim = c(48,52), ylab = "CTmax", xlab ="Acclimation temperature")
abline(lm(SmCTmax ~Treat), col = "blue")
par(new=TRUE)
plot(Treat, KmCTmax, , col = "green", ylim = c(48,52), ylab = "CTmax", xlab ="Acclimation temperature")
abline(lm(KmCTmax ~Treat), col = "green")
par(new=TRUE)
plot(Treat, BmCTmax, , col = "black", ylim = c(48,52), ylab = "CTmax", xlab ="Acclimation temperature")
abline(lm(BmCTmax ~Treat), col = "black")
legend(15.5, 52, legend=c("North", "Stampriet", "Karasburg", "Betta"),
       col=c("red", "blue", "green", "black"), lty=1, cex=0.8)


##########Chill coma recovery####

CCR <- read.table("Complete_data_file_CCR_270218.txt", header = TRUE, sep = "", dec = ',')
modelCCR <- lm(CCR ~ Population + Treatment + Population*Treatment, data=CCR)
summary(modelCCR)

a <- aov(CCR ~ Population + Treatment + Population*Treatment, data=CCR)
summary(a)


#subset - CCR - population
CCRN <- subset(CCR, Population == "North")
CCRS <- subset(CCR, Population == "S")
CCRK <- subset(CCR, Population == "Karasburg")
CCRB <- subset(CCR, Population == "Betta")

par(mfrow=c(3,4))
plot(CCRN$D_21, CCRN$CCR, xlim =c(0,100), ylim=c(0,30))
abline(lm(CCRN$CCR ~ CCRN$D_21))
plot(CCRS$D_21, CCRS$CCR, xlim =c(0,100), ylim=c(0,30))
abline(lm(CCRS$CCR ~ CCRS$D_21))
plot(CCRK$D_21, CCRK$CCR, xlim =c(0,100), ylim=c(0,30))
abline(lm(CCRK$CCR ~ CCRK$D_21))
plot(CCRB$D_21, CCRB$CCR, xlim =c(0,100), ylim=c(0,30))
abline(lm(CCRB$CCR ~ CCRB$D_21))

#models - D_21
modelCCRN_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRN)
statCCRN_D_21 <- summary(modelCCRN_D_21)
modelCCRS_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRS)
statCCRS_D_21 <- summary(modelCCRS_D_21)
modelCCRK_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRK)
statCCRK_D_21 <- summary(modelCCRK_D_21)
modelCCRB_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRB)
statCCRB_D_21 <- summary(modelCCRB_D_21)

plot(CCRN$Mass, CCRN$CCR, xlim =c(0,50), ylim=c(0,30))
abline(lm(CCRN$CCR ~ CCRN$Mass))
plot(CCRS$Mass, CCRS$CCR, xlim =c(0,50), ylim=c(0,30))
abline(lm(CCRS$CCR ~ CCRS$Mass))
plot(CCRK$Mass, CCRK$CCR, xlim =c(0,50), ylim=c(0,30))
abline(lm(CCRK$CCR ~ CCRK$Mass))
plot(CCRB$Mass, CCRB$CCR, xlim =c(0,50), ylim=c(0,30))
abline(lm(CCRB$CCR ~ CCRB$Mass))

#models - Mass
modelCCRN_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRN)
statCCRN_Mass <- summary(modelCCRN_Mass)
modelCCRS_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRS)
statCCRS_Mass <- summary(modelCCRS_Mass)
modelCCRK_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRK)
statCCRK_Mass <- summary(modelCCRK_Mass)
modelCCRB_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRB)
statCCRB_Mass <- summary(modelCCRB_Mass)

plot(CCRN$Fed, CCRN$CCR, xlim =c(0,5), ylim=c(0,30))
abline(lm(CCRN$CCR ~ CCRN$Fed))
plot(CCRS$Fed, CCRS$CCR, xlim =c(0,5), ylim=c(0,30))
abline(lm(CCRS$CCR ~ CCRS$Fed))
plot(CCRK$Fed, CCRK$CCR, xlim =c(0,5), ylim=c(0,30))
abline(lm(CCRK$CCR ~ CCRK$Fed))
plot(CCRB$Fed, CCRB$CCR, xlim =c(0,5), ylim=c(0,30))
abline(lm(CCRB$CCR ~ CCRB$Fed))

#models - Fed
modelCCRN_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRN)
statCCRN_Fed <- summary(modelCCRN_Fed)
modelCCRS_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRS)
statCCRS_Fed <- summary(modelCCRS_Fed)
modelCCRK_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRK)
statCCRK_Fed <- summary(modelCCRK_Fed)
modelCCRB_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRB)
statCCRB_Fed <- summary(modelCCRB_Fed)

#subset - CCR - population - treatment
CCRN15 <- subset(CCRN, Treatment == "15")
CCRN19 <- subset(CCRN, Treatment == "19")
CCRN23 <- subset(CCRN, Treatment == "23")
CCRN25 <- subset(CCRN, Treatment == "25")
CCRN29 <- subset(CCRN, Treatment == "29")


pdf("North_CCR.pdf", width=18, height=15)
par(mfrow=c(3,5))
plot(CCRN15$D_21, CCRN15$CCR, xlim =c(0,100))
abline(lm(CCRN15$CCR ~ CCRN15$D_21))
modelCCRN15_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRN15)
statCCRN15_D_21 <- summary(modelCCRN15_D_21)
plot(CCRN19$D_21, CCRN19$CCR, xlim =c(0,100))
abline(lm(CCRN19$CCR ~ CCRN19$D_21))
modelCCRN19_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRN19)
statCCRN19_D_21 <- summary(modelCCRN19_D_21)
plot(CCRN23$D_21, CCRN23$CCR, xlim =c(0,100))
abline(lm(CCRN23$CCR ~ CCRN23$D_21))
modelCCRN23_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRN23)
statCCRN23_D_21 <- summary(modelCCRN23_D_21)
plot(CCRN25$D_21, CCRN25$CCR, xlim =c(0,100))
abline(lm(CCRN25$CCR ~ CCRN25$D_21))
modelCCRN25_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRN25)
statCCRN25_D_21 <- summary(modelCCRN25_D_21)
plot(CCRN29$D_21, CCRN29$CCR, xlim =c(0,100))
abline(lm(CCRN29$CCR ~ CCRN29$D_21))
modelCCRN29_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRN29)
statCCRN29_D_21 <- summary(modelCCRN29_D_21)
####
plot(CCRN15$Mass, CCRN15$CCR, xlim =c(0,50))
abline(lm(CCRN15$CCR ~ CCRN15$Mass))
modelCCRN15_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRN15)
statCCRN15_Mass <- summary(modelCCRN15_Mass)
plot(CCRN19$Mass, CCRN19$CCR, xlim =c(0,50))
abline(lm(CCRN19$CCR ~ CCRN19$Mass))
modelCCRN19_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRN19)
statCCRN19_Mass  <- summary(modelCCRN19_Mass )
plot(CCRN23$Mass , CCRN23$CCR, xlim =c(0,50))
abline(lm(CCRN23$CCR ~ CCRN23$Mass ))
modelCCRN23_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRN23)
statCCRN23_Mass <- summary(modelCCRN23_Mass)
plot(CCRN25$Mass, CCRN25$CCR, xlim =c(0,50))
abline(lm(CCRN25$CCR ~ CCRN25$Mass))
modelCCRN25_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRN25)
statCCRN25_Mass <- summary(modelCCRN25_Mass)
plot(CCRN29$Mass, CCRN29$CCR, xlim =c(0,50))
abline(lm(CCRN29$CCR ~ CCRN29$Mass))
modelCCRN29_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRN29)
statCCRN29_Mass <- summary(modelCCRN29_Mass)
####
plot(CCRN15$Fed, CCRN15$CCR, xlim =c(0,5))
abline(lm(CCRN15$CCR ~ CCRN15$Fed))
modelCCRN15_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRN15)
statCCRN15_Fed <- summary(modelCCRN15_Fed)
plot(CCRN19$Fed, CCRN19$CCR, xlim =c(0,5))
abline(lm(CCRN19$CCR ~ CCRN19$Fed))
modelCCRN19_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRN19)
statCCRN19_Fed <- summary(modelCCRN19_Fed)
plot(CCRN23$Fed, CCRN23$CCR, xlim =c(0,5))
abline(lm(CCRN23$CCR ~ CCRN23$Fed))
modelCCRN23_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRN23)
statCCRN23_Fed <- summary(modelCCRN23_Fed)
plot(CCRN25$Fed, CCRN25$CCR, xlim =c(0,5))
abline(lm(CCRN25$CCR ~ CCRN25$Fed))
modelCCRN25_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRN25)
statCCRN25_Fed <- summary(modelCCRN25_Fed)
plot(CCRN29$Fed, CCRN29$CCR, xlim =c(0,5))
abline(lm(CCRN29$CCR ~ CCRN29$Fed))
modelCCRN29_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRN29)
statCCRN29_Fed <- summary(modelCCRN29_Fed)
dev.off()
#####

CCRS15 <- subset(CCRS, Treatment == "15")
CCRS19 <- subset(CCRS, Treatment == "19")
CCRS23 <- subset(CCRS, Treatment == "23")
CCRS25 <- subset(CCRS, Treatment == "25")
CCRS29 <- subset(CCRS, Treatment == "29")

###
pdf("S_CCR.pdf", width=18, height=15)
par(mfrow=c(3,5))
plot(CCRS15$D_21, CCRS15$CCR, xlim =c(0,100))
abline(lm(CCRS15$CCR ~ CCRS15$D_21))
modelCCRS15_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRS15)
statCCRS15_D_21 <- summary(modelCCRS15_D_21)
plot(CCRS19$D_21, CCRS19$CCR, xlim =c(0,100))
abline(lm(CCRS19$CCR ~ CCRS19$D_21))
modelCCRS19_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRS19)
statCCRS19_D_21 <- summary(modelCCRS19_D_21)
plot(CCRS23$D_21, CCRS23$CCR, xlim =c(0,100))
abline(lm(CCRS23$CCR ~ CCRS23$D_21))
modelCCRS23_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRS23)
statCCRS23_D_21 <- summary(modelCCRS23_D_21)
plot(CCRS25$D_21, CCRS25$CCR, xlim =c(0,100))
abline(lm(CCRS25$CCR ~ CCRS25$D_21))
modelCCRS25_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRS25)
statCCRS25_D_21 <- summary(modelCCRS25_D_21)
plot(CCRS29$D_21, CCRS29$CCR, xlim =c(0,100))
abline(lm(CCRS29$CCR ~ CCRS29$D_21))
modelCCRS29_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRS29)
statCCRS29_D_21 <- summary(modelCCRS29_D_21)
####
plot(CCRS15$Mass, CCRS15$CCR, xlim =c(0,50))
abline(lm(CCRS15$CCR ~ CCRS15$Mass))
modelCCRS15_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRS15)
statCCRS15_Mass <- summary(modelCCRS15_Mass)
plot(CCRS19$Mass, CCRS19$CCR, xlim =c(0,50))
abline(lm(CCRS19$CCR ~ CCRS19$Mass))
modelCCRS19_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRS19)
statCCRS19_Mass  <- summary(modelCCRS19_Mass )
plot(CCRS23$Mass , CCRS23$CCR, xlim =c(0,50))
abline(lm(CCRS23$CCR ~ CCRS23$Mass ))
modelCCRS23_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRS23)
statCCRS23_Mass <- summary(modelCCRS23_Mass)
plot(CCRS25$Mass, CCRS25$CCR, xlim =c(0,50))
abline(lm(CCRS25$CCR ~ CCRS25$Mass))
modelCCRS25_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRS25)
statCCRS25_Mass <- summary(modelCCRS25_Mass)
plot(CCRS29$Mass, CCRS29$CCR, xlim =c(0,50))
abline(lm(CCRS29$CCR ~ CCRS29$Mass))
modelCCRS29_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRS29)
statCCRS29_Mass <- summary(modelCCRS29_Mass)
####
plot(CCRS15$Fed, CCRS15$CCR, xlim =c(0,5))
abline(lm(CCRS15$CCR ~ CCRS15$Fed))
modelCCRS15_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRS15)
statCCRS15_Fed <- summary(modelCCRS15_Fed)
plot(CCRS19$Fed, CCRS19$CCR, xlim =c(0,5))
abline(lm(CCRS19$CCR ~ CCRS19$Fed))
modelCCRS19_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRS19)
statCCRS19_Fed <- summary(modelCCRS19_D_21)
plot(CCRS23$Fed, CCRS23$CCR, xlim =c(0,5))
abline(lm(CCRS23$CCR ~ CCRS23$Fed))
modelCCRS23_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRS23)
statCCRS23_Fed <- summary(modelCCRS23_Fed)
plot(CCRS25$Fed, CCRS25$CCR, xlim =c(0,5))
abline(lm(CCRS25$CCR ~ CCRS25$Fed))
modelCCRS25_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRS25)
statCCRS25_Fed <- summary(modelCCRS25_Fed)
plot(CCRS29$Fed, CCRS29$CCR, xlim =c(0,5))
abline(lm(CCRS29$CCR ~ CCRS29$Fed))
modelCCRS29_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRS29)
statCCRS29_Fed <- summary(modelCCRS29_Fed)
dev.off()
#####

CCRK15 <- subset(CCRK, Treatment == "15")
CCRK19 <- subset(CCRK, Treatment == "19")
CCRK23 <- subset(CCRK, Treatment == "23")
CCRK25 <- subset(CCRK, Treatment == "25")
CCRK29 <- subset(CCRK, Treatment == "29")

###
pdf("Karasburg_CCR.pdf", width=18, height=15)
par(mfrow=c(3,5))
plot(CCRK15$D_21, CCRK15$CCR, xlim =c(0,100))
abline(lm(CCRK15$CCR ~ CCRK15$D_21))
modelCCRK15_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRK15)
statCCRK15_D_21 <- summary(modelCCRK15_D_21)
plot(CCRK19$D_21, CCRK19$CCR, xlim =c(0,100))
abline(lm(CCRK19$CCR ~ CCRK19$D_21))
modelCCRK19_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRK19)
statCCRK19_D_21 <- summary(modelCCRK19_D_21)
plot(CCRK23$D_21, CCRK23$CCR, xlim =c(0,100))
abline(lm(CCRK23$CCR ~ CCRK23$D_21))
modelCCRK23_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRK23)
statCCRK23_D_21 <- summary(modelCCRK23_D_21)
plot(CCRK25$D_21, CCRK25$CCR, xlim =c(0,100))
abline(lm(CCRK25$CCR ~ CCRK25$D_21))
modelCCRK25_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRK25)
statCCRK25_D_21 <- summary(modelCCRK25_D_21)
plot(CCRK29$D_21, CCRK29$CCR, xlim =c(0,100))
abline(lm(CCRK29$CCR ~ CCRK29$D_21))
modelCCRK29_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRK29)
statCCRK29_D_21 <- summary(modelCCRK29_D_21)
####
plot(CCRK15$Mass, CCRK15$CCR, xlim =c(0,50))
abline(lm(CCRK15$CCR ~ CCRK15$Mass))
modelCCRK15_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRK15)
statCCRK15_Mass <- summary(modelCCRK15_Mass)
plot(CCRK19$Mass, CCRK19$CCR, xlim =c(0,50))
abline(lm(CCRK19$CCR ~ CCRK19$Mass))
modelCCRK19_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRK19)
statCCRK19_Mass <- summary(modelCCRK19_Mass)
plot(CCRK23$Mass, CCRK23$CCR, xlim =c(0,50))
abline(lm(CCRK23$CCR ~ CCRK23$Mass))
modelCCRK23_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRK23)
statCCRK23_Mass <- summary(modelCCRK23_Mass)
plot(CCRK25$Mass, CCRK25$CCR, xlim =c(0,50))
abline(lm(CCRK25$CCR ~ CCRK25$Mass))
modelCCRK25_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRK25)
statCCRK25_Mass <- summary(modelCCRK25_Mass)
plot(CCRK29$Mass, CCRK29$CCR, xlim =c(0,50))
abline(lm(CCRK29$CCR ~ CCRK29$Mass))
modelCCRK29_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRK29)
statCCRK29_Mass <- summary(modelCCRK29_Mass)
####
plot(CCRK15$Fed, CCRK15$CCR, xlim =c(0,5))
abline(lm(CCRK15$CCR ~ CCRK15$Fed))
modelCCRK15_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRK15)
statCCRK15_Fed <- summary(modelCCRK15_Fed)
plot(CCRK19$Fed, CCRK19$CCR, xlim =c(0,5))
abline(lm(CCRK19$CCR ~ CCRK19$Fed))
modelCCRK19_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRK19)
statCCRK19_Fed <- summary(modelCCRK19_Fed)
plot(CCRK23$Fed, CCRK23$CCR, xlim =c(0,5))
abline(lm(CCRK23$CCR ~ CCRK23$Fed))
modelCCRK23_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRK23)
statCCRK23_Fed <- summary(modelCCRK23_Fed)
plot(CCRK25$Fed, CCRK25$CCR, xlim =c(0,5))
abline(lm(CCRK25$CCR ~ CCRK25$Fed))
modelCCRK25_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRK25)
statCCRK25_Fed <- summary(modelCCRK25_Fed)
plot(CCRK29$Fed, CCRK29$CCR, xlim =c(0,5))
abline(lm(CCRK29$CCR ~ CCRK29$Fed))
modelCCRK29_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRK29)
statCCRK29_Fed <- summary(modelCCRK29_Fed)
dev.off()
#####

CCRB15 <- subset(CCRB, Treatment == "15")
CCRB19 <- subset(CCRB, Treatment == "19")
CCRB23 <- subset(CCRB, Treatment == "23")
CCRB25 <- subset(CCRB, Treatment == "25")
CCRB29 <- subset(CCRB, Treatment == "29")

###
pdf("Betta_CCR.pdf", width=18, height=15)
par(mfrow=c(3,5))
plot(CCRB15$D_21, CCRB15$CCR, xlim =c(0,100))
abline(lm(CCRB15$CCR ~ CCRB15$D_21))
modelCCRB15_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRB15)
statCCRB15_D_21 <- summary(modelCCRB15_D_21)
plot(CCRB19$D_21, CCRB19$CCR, xlim =c(0,100))
abline(lm(CCRB19$CCR ~ CCRB19$D_21))
modelCCRB19_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRB19)
statCCRB19_D_21 <- summary(modelCCRB19_D_21)
plot(CCRB23$D_21, CCRB23$CCR, xlim =c(0,100))
abline(lm(CCRB23$CCR ~ CCRB23$D_21))
modelCCRB23_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRB23)
statCCRB23_D_21 <- summary(modelCCRB23_D_21)
plot(CCRB25$D_21, CCRB25$CCR, xlim =c(0,100))
abline(lm(CCRB25$CCR ~ CCRB25$D_21))
modelCCRB25_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRB25)
statCCRB25_D_21 <- summary(modelCCRB25_D_21)
plot(CCRB29$D_21, CCRB29$CCR, xlim =c(0,100))
abline(lm(CCRB29$CCR ~ CCRB29$D_21))
modelCCRB29_D_21 <- lm(CCR ~ D_21 + Treatment + D_21*Treatment, data=CCRB29)
statCCRB29_D_21 <- summary(modelCCRB29_D_21)
####
plot(CCRB15$Mass, CCRB15$CCR, xlim =c(0,50))
abline(lm(CCRB15$CCR ~ CCRB15$Mass))
modelCCRB15_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRB15)
statCCRB15_Mass <- summary(modelCCRB15_Mass)
plot(CCRB19$Mass, CCRB19$CCR, xlim =c(0,50))
abline(lm(CCRB19$CCR ~ CCRB19$Mass))
modelCCRB19_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRB19)
statCCRB19_Mass  <- summary(modelCCRB19_Mass )
plot(CCRB23$Mass , CCRB23$CCR, xlim =c(0,50))
abline(lm(CCRB23$CCR ~ CCRB23$Mass ))
modelCCRB23_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRB23)
statCCRB23_Mass <- summary(modelCCRB23_Mass)
plot(CCRB25$Mass, CCRB25$CCR, xlim =c(0,50))
abline(lm(CCRB25$CCR ~ CCRB25$Mass))
modelCCRB25_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRB25)
statCCRB25_Mass <- summary(modelCCRB25_Mass)
plot(CCRB29$Mass, CCRB29$CCR, xlim =c(0,50))
abline(lm(CCRB29$CCR ~ CCRB29$Mass))
modelCCRB29_Mass <- lm(CCR ~ Mass + Treatment + Mass*Treatment, data=CCRB29)
statCCRB29_Mass <- summary(modelCCRB29_Mass)
####
plot(CCRB15$Fed, CCRB15$CCR, xlim =c(0,5))
abline(lm(CCRB15$CCR ~ CCRB15$Fed))
modelCCRB15_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRB15)
statCCRB15_Fed <- summary(modelCCRB15_Fed)
plot(CCRB19$Fed, CCRB19$CCR, xlim =c(0,5))
abline(lm(CCRB19$CCR ~ CCRB19$Fed))
modelCCRB19_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRB19)
statCCRB19_Fed  <- summary(modelCCRB19_Fed )
plot(CCRB23$Fed , CCRB23$CCR, xlim =c(0,5))
abline(lm(CCRB23$CCR ~ CCRB23$Fed ))
modelCCRB23_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRB23)
statCCRB23_Fed <- summary(modelCCRB23_Fed)
plot(CCRB25$Fed, CCRB25$CCR, xlim =c(0,5))
abline(lm(CCRB25$CCR ~ CCRB25$Fed))
modelCCRB25_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRB25)
statCCRB25_Fed <- summary(modelCCRB25_Fed)
plot(CCRB29$Fed, CCRB29$CCR, xlim =c(0,5))
abline(lm(CCRB29$CCR ~ CCRB29$Fed))
modelCCRB29_Fed <- lm(CCR ~ Fed + Treatment + Fed*Treatment, data=CCRB29)
statCCRB29_Fed <- summary(modelCCRB29_Fed)
dev.off()
#####

##reduced data ("CCR_final")

index <- CCR[,4]==1
CCR_mean <- colMeans(matrix(CCR$CCR,10),na.rm=T)
CCR_final <- cbind(CCR[index,],CCR_mean)

plot(CCR_final$Treatment, CCR_final$CCR_mean, ylim=c(0,30))
abline(lm(CCR_final$CCR_mean ~ CCR_final$Treatment))

modelCCR_final <- lm(CCR_mean ~ Population + Treatment + Population * Treatment, data=CCR_final)
summary(modelCCR_final)
CCR_finalaov <- aov(CCR_mean ~ Population + Treatment + Population *Treatment, data=CCR_final)
summary(CCR_finalaov)

error.bars(CCR_final, alpha=0.05, sd=TRUE, labels = NULL, pos = NULL,  arrow.len = 0.05,arrow.col="black", add = FALSE,bars=FALSE,within=FALSE, col="blue",...)

#########

#subset - CCR_final - population
CCR_finalN <- subset(CCR_final, Population == "North")
CCR_finalS <- subset(CCR_final, Population == "S")
CCR_finalK <- subset(CCR_final, Population == "Karasburg")
CCR_finalB <- subset(CCR_final, Population == "Betta")

par(mfrow=c(1,4))
plot(CCR_finalN$Treatment, CCR_finalN$CCR_mean, ylim=c(0,20), xlab = "Treatment", ylab = "CCR", main = "Chill coma recovery - North")
abline(lm(CCR_finalN$CCR_mean ~ CCR_finalN$Treatment), col = "red")
plot(CCR_finalS$Treatment, CCR_finalS$CCR_mean, ylim=c(0,20), xlab = "Treatment", ylab = "CCR", main = "Chill coma recovery - Stampriet")
abline(lm(CCR_finalS$CCR_mean ~ CCR_finalS$Treatment), col = "blue")
plot(CCR_finalK$Treatment, CCR_finalK$CCR_mean, ylim=c(0,20), xlab = "Treatment", ylab = "CCR", main = "Chill coma recovery - Karasburg")
abline(lm(CCR_finalK$CCR_mean ~ CCR_finalK$Treatment), col = "green")
plot(CCR_finalB$Treatment, CCR_finalB$CCR_mean, ylim=c(0,20), xlab = "Treatment", ylab = "CCR", main = "Chill coma recovery - Betta")
abline(lm(CCR_finalB$CCR_mean ~ CCR_finalB$Treatment), col = "black")

#models
modelCCR_finalN <- lm(CCR ~ Treatment, data=CCR_finalN)
statCCR_finalN <- summary(modelCCR_finalN)
modelCCR_finalS <- lm(CCR ~ Treatment, data=CCR_finalS)
statCCR_finalS <- summary(modelCCR_finalS)
modelCCR_finalK <- lm(CCR ~ Treatment, data=CCR_finalK)
statCCR_finalK <- summary(modelCCR_finalK)
modelCCR_finalB <- lm(CCR ~ Treatment, data=CCR_finalB)
statCCR_finalB <- summary(modelCCR_finalB)

par(mfrow=c(4,4))
plot(modelCCR_finalN)
plot(modelCCR_finalS)
plot(modelCCR_finalK)
plot(modelCCR_finalB)

#subset - CCR_final - treatment
CCR_final15 <- subset(CCR_final, Treatment == "15")
CCR_final19 <- subset(CCR_final, Treatment == "19")
CCR_final23 <- subset(CCR_final, Treatment == "23")
CCR_final25 <- subset(CCR_final, Treatment == "25")
CCR_final29 <- subset(CCR_final, Treatment == "29")

par(mfrow=c(1,5))
plot(factor(CCR_final15$Population, levels = c("Betta", "S", "Karasburg", "North")), CCR_final15$CCR_mean, ylim=c(0,25), xlab = "Population", ylab = "CCR", main = "Acclimation - 15")
plot(factor(CCR_final19$Population, levels = c("Betta", "S", "Karasburg", "North")), CCR_final19$CCR_mean, ylim=c(0,25), xlab = "Population", ylab = "CCR", main = "Acclimation - 19")
plot(factor(CCR_final23$Population, levels = c("Betta", "S", "Karasburg", "North")), CCR_final23$CCR_mean, ylim=c(0,25), xlab = "Population", ylab = "CCR", main = "Acclimation - 23")
plot(factor(CCR_final25$Population, levels = c("Betta", "S", "Karasburg", "North")), CCR_final25$CCR_mean, ylim=c(0,25), xlab = "Population", ylab = "CCR", main = "Acclimation - 25")
plot(factor(CCR_final29$Population, levels = c("Betta", "S", "Karasburg", "North")), CCR_final29$CCR_mean, ylim=c(0,25), xlab = "Population", ylab = "CCR", main = "Acclimation - 29")

#models
modelCCR_final15 <- lm(CCR ~ Population, data=CCR_final15)
statCCR_final15 <- summary(modelCCR_final15)
modelCCR_final19 <- lm(CCR ~ Population, data=CCR_final19)
statCCR_final19 <- summary(modelCCR_final19)
modelCCR_final23 <- lm(CCR ~ Population, data=CCR_final23)
statCCR_final23 <- summary(modelCCR_final23)
modelCCR_final25 <- lm(CCR ~ Population, data=CCR_final25)
statCCR_final25 <- summary(modelCCR_final25)
modelCCR_final29 <- lm(CCR ~ Population, data=CCR_final29)
statCCR_final29 <- summary(modelCCR_final29)

par(mfrow=c(5,4))
plot(modelCCR_final15)
plot(modelCCR_final19)
plot(modelCCR_final23)
plot(modelCCR_final25)
plot(modelCCR_final29)

#####################
CCR_finalN15 <- subset(CCR_final, Population == "North" & Treatment == "15")
CCR_finalN19 <- subset(CCR_final, Population == "North" & Treatment == "19")
CCR_finalN23 <- subset(CCR_final, Population == "North" & Treatment == "23")
CCR_finalN25 <- subset(CCR_final, Population == "North" & Treatment == "25")
CCR_finalN29 <- subset(CCR_final, Population == "North" & Treatment == "29")
CCR_finalS15 <- subset(CCR_final, Population == "S" & Treatment == "15")
CCR_finalS19 <- subset(CCR_final, Population == "S" & Treatment == "19")
CCR_finalS23 <- subset(CCR_final, Population == "S" & Treatment == "23")
CCR_finalS25 <- subset(CCR_final, Population == "S" & Treatment == "25")
CCR_finalS29 <- subset(CCR_final, Population == "S" & Treatment == "29")
CCR_finalK15 <- subset(CCR_final, Population == "Karasburg" & Treatment == "15")
CCR_finalK19 <- subset(CCR_final, Population == "Karasburg" & Treatment == "19")
CCR_finalK23 <- subset(CCR_final, Population == "Karasburg" & Treatment == "23")
CCR_finalK25 <- subset(CCR_final, Population == "Karasburg" & Treatment == "25")
CCR_finalK29 <- subset(CCR_final, Population == "Karasburg" & Treatment == "29")
CCR_finalB15 <- subset(CCR_final, Population == "Betta" & Treatment == "15")
CCR_finalB19 <- subset(CCR_final, Population == "Betta" & Treatment == "19")
CCR_finalB23 <- subset(CCR_final, Population == "Betta" & Treatment == "23")
CCR_finalB25 <- subset(CCR_final, Population == "Betta" & Treatment == "25")
CCR_finalB29 <- subset(CCR_final, Population == "Betta" & Treatment == "29")

#plots
Treat <- c(15, 19, 23, 25, 29)
NmCCR <- c(colMeans(matrix(CCR_finalN15$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalN19$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalN23$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalN25$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalN29$CCR_mean),na.rm=T))
SmCCR <- c(colMeans(matrix(CCR_finalS15$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalS19$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalS23$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalS25$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalS29$CCR_mean),na.rm=T))
KmCCR <- c(colMeans(matrix(CCR_finalK15$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalK19$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalK23$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalK25$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalK29$CCR_mean),na.rm=T))
BmCCR <- c(colMeans(matrix(CCR_finalB15$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalB19$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalB23$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalB25$CCR_mean),na.rm=T), colMeans(matrix(CCR_finalB29$CCR_mean),na.rm=T))


plot(Treat, NmCCR, , col = "red", ylim = c(0,15), ylab = "CCR", xlab ="Acclimation temperature", main ="Chill coma recovery")
abline(lm(NmCCR ~Treat), col = "red")
par(new=TRUE)
plot(Treat, SmCCR, , col = "blue", ylim = c(0,15), ylab = "CCR", xlab ="Acclimation temperature")
abline(lm(SmCCR ~Treat), col = "blue")
par(new=TRUE)
plot(Treat, KmCCR, , col = "green", ylim = c(0,15), ylab = "CCR", xlab ="Acclimation temperature")
abline(lm(KmCCR ~Treat), col = "green")
par(new=TRUE)
plot(Treat, BmCCR, , col = "black", ylim = c(0,15), ylab = "CCR", xlab ="Acclimation temperature")
abline(lm(BmCCR ~Treat), col = "black")
legend(15, 5, legend=c("North", "Stampriet", "Karasburg", "Betta"),
       col=c("red", "blue", "green", "black"), lty=1, cex=0.8)


